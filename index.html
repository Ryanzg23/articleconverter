<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Live Text to HTML Converter with OL support</title>
<style>
  body { font-family: Arial, sans-serif; margin: 2rem; background: #f9f9f9; }
  #container { margin-top: 1rem; }
  pre#output {
    background: #eee;
    padding: 15px;
    border-radius: 6px;
    white-space: pre-wrap;
    word-wrap: break-word;
    font-family: Consolas, monospace;
  }
  button {
    cursor: pointer;
    padding: 8px 14px;
    margin-top: 10px;
    border-radius: 5px;
    border: none;
    background-color: #009cff;
    color: white;
    font-size: 1rem;
  }
  button:disabled {
    background-color: #777;
    cursor: default;
  }
</style>
</head>
<body>

<h2>Live Text to HTML Converter with OL/UL support</h2>
<textarea id="inputText" rows="12" style="width:100%; font-family: monospace; font-size: 1rem;"
placeholder="Paste or type your text here..."></textarea>

<div id="container"></div>

<script>
function escapeHTML(html) {
  return html.replace(/&/g, "&amp;")
             .replace(/</g, "&lt;")
             .replace(/>/g, "&gt;");
}

// Helper: check if line starts with number + dot + space, e.g. "1. ", "2. "
function startsWithNumber(line) {
  return /^\d+\.\s/.test(line);
}

function convertToHTML(inputText) {
  const rawLines = inputText.split(/\r?\n/);

  const output = [];
  let i = 0;

  while (i < rawLines.length) {
    let line = rawLines[i].trim();

    if (line === "") {
      i++;
      continue;
    }

    // Headings
    if (line.startsWith("<h1>") || line.startsWith("<h2>")) {
      const isH1 = line.startsWith("<h1>");
      const tag = isH1 ? "h1" : "h2";
      const content = line.replace(/^<h[12]>/, "").replace(/<\/h[12]>$/, "").trim();

      if (isH1) {
        output.push(`<h1 style="border-bottom: 3px #009cff solid; text-align: center">${content}</h1>`);
      } else {
        output.push(`<h2>${content}</h2>`);
      }
      i++;
      continue;
    }

    // Numbered OL list processing with stop condition on heading inside list
    if (startsWithNumber(line)) {
      const olItems = [];

      while (i < rawLines.length && startsWithNumber(rawLines[i].trim())) {
        // Title line, remove number prefix
        let numberLine = rawLines[i].trim();
        const title = numberLine.replace(/^\d+\.\s*/, "");
        i++;

        const itemParagraphs = [];
        let paraLines = [];

        while (i < rawLines.length) {
          const currentLine = rawLines[i].trim();

          // Stop if next line is numbered item or heading tag
          if (startsWithNumber(currentLine) || currentLine.startsWith("<h1>") || currentLine.startsWith("<h2>")) {
            break;
          }

          if (currentLine === "") {
            if (paraLines.length) {
              itemParagraphs.push(paraLines.join(" "));
              paraLines = [];
            }
          } else {
            paraLines.push(currentLine);
          }
          i++;
        }
        if (paraLines.length) {
          itemParagraphs.push(paraLines.join(" "));
        }

        // Build liContent with 1 <br> after title, then <br><br> between subsequent paragraphs
        let liContent = title;
        if (itemParagraphs.length > 0) {
          liContent += "<br>" + itemParagraphs[0]; // first break is single <br>
        }
        for (let j = 1; j < itemParagraphs.length; j++) {
          liContent += "<br><br>" + itemParagraphs[j]; // subsequent breaks are double <br><br>
        }

        // Check if this is the last item
		const isLast = (i >= rawLines.length) || !startsWithNumber(rawLines[i].trim());
		if (isLast) {
		  olItems.push(`<li>${liContent}</li>`);
		} else {
		  olItems.push(`<li>${liContent}</li><br>`);
		}
		  
      }

      output.push("<ol>");
      output.push(...olItems);
      output.push("</ol>");
      continue;
    }

    // Default paragraph
    output.push(`<p>${line}</p>`);
    i++;
  }

  return output.join("\n");
}


function addCopyButton(container) {
  // Remove existing button if any
  const existingBtn = container.querySelector("button");
  if (existingBtn) existingBtn.remove();

  const btn = document.createElement("button");
  btn.textContent = "Copy Code";

  btn.addEventListener("click", () => {
    const codeText = document.getElementById("output").innerText;
    navigator.clipboard.writeText(codeText).then(() => {
      const original = btn.textContent;
      btn.textContent = "Copied!";
      btn.disabled = true;
      setTimeout(() => {
        btn.textContent = original;
        btn.disabled = false;
      }, 2000);
    });
  });

  container.insertBefore(btn, container.firstChild);
}

const inputTextarea = document.getElementById("inputText");
const container = document.getElementById("container");

inputTextarea.addEventListener("input", () => {
  const inputText = inputTextarea.value.trim();

  if (!inputText) {
    container.innerHTML = ""; // Clear output if input empty
    return;
  }

  const htmlOutput = convertToHTML(inputText);
  const escapedOutput = escapeHTML(htmlOutput);

  container.innerHTML = `<pre id="output">${escapedOutput}</pre>`;
  addCopyButton(container);
});
</script>

</body>
</html>
